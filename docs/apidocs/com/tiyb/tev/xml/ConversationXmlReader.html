<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.5) on Mon Feb 10 13:01:07 EST 2020 -->
<title>ConversationXmlReader (tev v9.0.2 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2020-02-10">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ConversationXmlReader (tev v9.0.2 API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9,"i6":9,"i7":9,"i8":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ConversationXmlReader.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.tiyb.tev.xml</a></div>
<h2 title="Class ConversationXmlReader" class="title">Class ConversationXmlReader</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="TEVXmlReader.html" title="class in com.tiyb.tev.xml">com.tiyb.tev.xml.TEVXmlReader</a></li>
<li>
<ul class="inheritance">
<li>com.tiyb.tev.xml.ConversationXmlReader</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public class <span class="typeNameLabel">ConversationXmlReader</span>
extends <a href="TEVXmlReader.html" title="class in com.tiyb.tev.xml">TEVXmlReader</a></pre>
<div class="block">This class is responsible for reading in an XML export from Tumblr containing
 conversations. A couple of interesting caveats:
 
 <ul>
 <li>message[@type=IMAGE] has a child element, for the photo's URL, whereas
 other messages just have the text of the message in the "message" element
 itself.</li>
 <li>For some reason two different formats are used for identifying users; the
 "participants" element has their <b>name</b>, but actual messages have their
 internal <b>ID</b>. These two don't relate to each other in any way. So the
 internal ID for the TEV user has to be inferred.</li>
 </ul></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>tiyb</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="ConversationXmlReader.MessageSuperStructure.html" title="class in com.tiyb.tev.xml">ConversationXmlReader.MessageSuperStructure</a></span></code></th>
<td class="colLast">
<div class="block">Helper class (essentially a struct), returned from the
 <a href="#getMessages(javax.xml.stream.XMLEventReader,java.lang.String)"><code>getMessages()</code></a> method, which needs to return more complicated data than just
 the list of messages - it also needs to determine the participant ID</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="ConversationXmlReader.Participant.html" title="class in com.tiyb.tev.xml">ConversationXmlReader.Participant</a></span></code></th>
<td class="colLast">
<div class="block">Helper class (essentially a struct), used for working with participant
 information.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.com.tiyb.tev.xml.TEVXmlReader">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;com.tiyb.tev.xml.<a href="TEVXmlReader.html" title="class in com.tiyb.tev.xml">TEVXmlReader</a></h3>
<code><a href="TEVXmlReader.html#END_OF_FILE_ERROR">END_OF_FILE_ERROR</a>, <a href="TEVXmlReader.html#logger">logger</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">ConversationXmlReader</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#fixName(java.lang.String)">fixName</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;participantName)</code></th>
<td class="colLast">
<div class="block">Helper function used to "fix" names for deactivated users.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private static <a href="ConversationXmlReader.Participant.html" title="class in com.tiyb.tev.xml">ConversationXmlReader.Participant</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMainParticipant(java.io.InputStream)">getMainParticipant</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/InputStream.html?is-external=true" title="class or interface in java.io" class="externalLink">InputStream</a>&nbsp;xmlStream)</code></th>
<td class="colLast">
<div class="block">
 The XML is set up such that each conversation is between two participants:
 the main Tumblr user, and another user.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private static <a href="ConversationXmlReader.MessageSuperStructure.html" title="class in com.tiyb.tev.xml">ConversationXmlReader.MessageSuperStructure</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMessages(javax.xml.stream.XMLEventReader,java.lang.String)">getMessages</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLEventReader.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLEventReader</a>&nbsp;reader,
           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tumblrUserID)</code></th>
<td class="colLast">
<div class="block">Gets a list of messages (stops when the end of the conversation is reached).</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private static <a href="ConversationXmlReader.Participant.html" title="class in com.tiyb.tev.xml">ConversationXmlReader.Participant</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getParticipantName(javax.xml.stream.XMLEventReader,java.lang.String)">getParticipantName</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLEventReader.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLEventReader</a>&nbsp;reader,
                  <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tumblrUserName)</code></th>
<td class="colLast">
<div class="block">Helper function to get the participant name (and avatar URL) from a
 conversation.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#parseDocument(org.springframework.web.multipart.MultipartFile,com.tiyb.tev.controller.TEVMetadataRestController,com.tiyb.tev.controller.TEVConvoRestController,java.lang.String)">parseDocument</a></span>&#8203;(org.springframework.web.multipart.MultipartFile&nbsp;xmlFile,
             <a href="../controller/TEVMetadataRestController.html" title="class in com.tiyb.tev.controller">TEVMetadataRestController</a>&nbsp;mdController,
             <a href="../controller/TEVConvoRestController.html" title="class in com.tiyb.tev.controller">TEVConvoRestController</a>&nbsp;convoController,
             <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;blogName)</code></th>
<td class="colLast">
<div class="block">
 Main method.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#readConversations(java.io.InputStream,java.lang.String,java.lang.String,com.tiyb.tev.controller.TEVMetadataRestController,com.tiyb.tev.controller.TEVConvoRestController,java.lang.String)">readConversations</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/InputStream.html?is-external=true" title="class or interface in java.io" class="externalLink">InputStream</a>&nbsp;xmlFile,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;mainTumblrUserName,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;mainTumblrUserId,
                 <a href="../controller/TEVMetadataRestController.html" title="class in com.tiyb.tev.controller">TEVMetadataRestController</a>&nbsp;mdController,
                 <a href="../controller/TEVConvoRestController.html" title="class in com.tiyb.tev.controller">TEVConvoRestController</a>&nbsp;convoController,
                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;blogName)</code></th>
<td class="colLast">
<div class="block">
 Reads in the XML file, conversation by conversation.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#readImageMessage(javax.xml.stream.XMLEventReader)">readImageMessage</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLEventReader.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLEventReader</a>&nbsp;reader)</code></th>
<td class="colLast">
<div class="block">This helper method reads in message content for IMAGE messages.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#readMessageAttributes(javax.xml.stream.events.StartElement,com.tiyb.tev.datamodel.ConversationMessage,java.lang.String)">readMessageAttributes</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/events/StartElement.html?is-external=true" title="class or interface in javax.xml.stream.events" class="externalLink">StartElement</a>&nbsp;startElement,
                     <a href="../datamodel/ConversationMessage.html" title="class in com.tiyb.tev.datamodel">ConversationMessage</a>&nbsp;currentMessage,
                     <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tumblrUserID)</code></th>
<td class="colLast">
<div class="block">Helper method to read in a message's attributes</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#uploadMessagesForConvo(com.tiyb.tev.controller.TEVConvoRestController,java.util.List,java.lang.Long,java.lang.String)">uploadMessagesForConvo</a></span>&#8203;(<a href="../controller/TEVConvoRestController.html" title="class in com.tiyb.tev.controller">TEVConvoRestController</a>&nbsp;restController,
                      <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="../datamodel/ConversationMessage.html" title="class in com.tiyb.tev.datamodel">ConversationMessage</a>&gt;&nbsp;messages,
                      <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&nbsp;convoID,
                      <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;blogName)</code></th>
<td class="colLast">
<div class="block">Helper function to upload messages for a given conversation</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.com.tiyb.tev.xml.TEVXmlReader">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.tiyb.tev.xml.<a href="TEVXmlReader.html" title="class in com.tiyb.tev.xml">TEVXmlReader</a></h3>
<code><a href="TEVXmlReader.html#readCharacters(javax.xml.stream.XMLEventReader)">readCharacters</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ConversationXmlReader</h4>
<pre>public&nbsp;ConversationXmlReader()</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="parseDocument(org.springframework.web.multipart.MultipartFile,com.tiyb.tev.controller.TEVMetadataRestController,com.tiyb.tev.controller.TEVConvoRestController,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parseDocument</h4>
<pre class="methodSignature">public static&nbsp;void&nbsp;parseDocument&#8203;(org.springframework.web.multipart.MultipartFile&nbsp;xmlFile,
                                 <a href="../controller/TEVMetadataRestController.html" title="class in com.tiyb.tev.controller">TEVMetadataRestController</a>&nbsp;mdController,
                                 <a href="../controller/TEVConvoRestController.html" title="class in com.tiyb.tev.controller">TEVConvoRestController</a>&nbsp;convoController,
                                 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;blogName)</pre>
<div class="block"><p>
 Main method. There are multiple steps to parsing the XML file:
 </p>
 
 <ol>
 <li>Get a stream for the file</li>
 <li>Use that stream to call the <a href="#getMainParticipant(java.io.InputStream)"><code>getMainParticipant()</code></a> method to parse the XML document, to determine the main
 Tumblr user's name, avatar URL, and internal ID</li>
 <li>Update the application's metadata with that information</li>
 <li>Get a <i>new</i> stream (to start over at the beginning of the file)</li>
 <li>Use that stream to call the
 <a href="#readConversations(java.io.InputStream,java.lang.String,java.lang.String,com.tiyb.tev.controller.TEVMetadataRestController,com.tiyb.tev.controller.TEVConvoRestController,java.lang.String)"><code>readConversations()</code></a> method to parse the document again, this time reading in
 all of the data (making use of the main Tumblr user information captured
 earlier)</li>
 </ol>
 
 <p>
 Data is inserted directly into the database, via the REST APIs (accessed via
 the <code>convoRestController</code> parameter).
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>xmlFile</code> - File containing XML to be parsed</dd>
<dd><code>mdController</code> - Used for working with the application's metadata</dd>
<dd><code>convoController</code> - Used for updating the database as each
                        conversation/message is parsed</dd>
</dl>
</li>
</ul>
<a id="getMainParticipant(java.io.InputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMainParticipant</h4>
<pre class="methodSignature">private static&nbsp;<a href="ConversationXmlReader.Participant.html" title="class in com.tiyb.tev.xml">ConversationXmlReader.Participant</a>&nbsp;getMainParticipant&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/InputStream.html?is-external=true" title="class or interface in java.io" class="externalLink">InputStream</a>&nbsp;xmlStream)</pre>
<div class="block"><p>
 The XML is set up such that each conversation is between two participants:
 the main Tumblr user, and another user. Therefore, this helper function
 parses through the XML document looking for participants; as soon as it finds
 a participant that's been listed <b>more than once,</b> it makes that
 participant the main Tumblr user, so it returns that user (and, URL for the
 user's avatar, and ID).
 </p>
 
 <p>
 There are two versions of the user in the XML: the <b>name</b> and an
 <b>opaque ID</b>, but they don't map to each other in the XML document, so
 there's no way to tell which ID belongs to which user. So the code also looks
 for duplicate versions of IDs; when an ID is found in multiple conversations,
 it's assumed to be the ID of the TEV user.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>xmlStream</code> - The XML file to be parsed</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A <a href="ConversationXmlReader.Participant.html" title="class in com.tiyb.tev.xml"><code>Participant</code></a> object, with the relevant data</dd>
</dl>
</li>
</ul>
<a id="readConversations(java.io.InputStream,java.lang.String,java.lang.String,com.tiyb.tev.controller.TEVMetadataRestController,com.tiyb.tev.controller.TEVConvoRestController,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readConversations</h4>
<pre class="methodSignature">private static&nbsp;void&nbsp;readConversations&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/InputStream.html?is-external=true" title="class or interface in java.io" class="externalLink">InputStream</a>&nbsp;xmlFile,
                                      <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;mainTumblrUserName,
                                      <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;mainTumblrUserId,
                                      <a href="../controller/TEVMetadataRestController.html" title="class in com.tiyb.tev.controller">TEVMetadataRestController</a>&nbsp;mdController,
                                      <a href="../controller/TEVConvoRestController.html" title="class in com.tiyb.tev.controller">TEVConvoRestController</a>&nbsp;convoController,
                                      <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;blogName)
                               throws <a href="../exception/XMLParsingException.html" title="class in com.tiyb.tev.exception">XMLParsingException</a></pre>
<div class="block"><p>
 Reads in the XML file, conversation by conversation. Whenever a new
 conversation element is reached a new object is created, the participant is
 discovered (via <a href="#getParticipantName(javax.xml.stream.XMLEventReader,java.lang.String)"><code>getParticipantName()</code></a>, and then <a href="#getMessages(javax.xml.stream.XMLEventReader,java.lang.String)"><code>getMessages()</code></a> is called to get all of the messages. The count of that list
 is added to the conversation object.
 </p>
 
 <p>
 Logic also takes into account the "overwrite conversations" flag in metadata.
 If the flag is set, all data is wiped ahead of time. When the flag is not
 set, as each conversation is encountered the REST API is used to look for
 that conversation: if it's found and the number of new messages isn't greater
 than the number of existing messages it is left alone; otherwise, messages
 are wiped, the conversation is set to no longer be read-only, and the new set
 of messages is uploaded.
 </p>
 
 <p>
 Finally, it should be noted that participant <b>names</b> sometimes change,
 but their <b>IDs</b> stay the same. So when searching the database for
 existing conversations, the search is initially done by ID. In cases where a
 participant has <i>changed</i> their name (and overwrite is set to false),
 the name will be updated in the DB. In some cases, where all of the messages
 were sent from the main blog (none received from the participant), the
 conversation is saved to the DB with an empty Participant ID (since the only
 place to get that ID is from a message received from the Participant). For
 this reason, the search for Conversations has a fallback, whereby it searches
 by name if searching by ID turns up 0 results. In cases where where 1) an
 initial import is performed, including a conversation with messages sent from
 the main blog and non received from the Participant; 2) a new export is
 uploaded (with overwrite turned off); 3) the conversation was augmented with
 messages from the Participant; <i>and</i> 4) the Participant changed their
 name, a duplicate conversation will be created. This is made even more
 confusing by the fact that participant <b>names</b> are sometimes reused, so
 the code looks for duplicate names, and appends a "1" to the end. (i.e.
 "blogname", "blogname 1", "blogname 1 1", etc.)
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>xmlFile</code> - Stream containing the XML file to be parsed</dd>
<dd><code>mainTumblrUserName</code> - The Tumblr name of the user of the application</dd>
<dd><code>mainTumblrUserId</code> - The ID assigned to the user of the application by
                           Tumblr</dd>
<dd><code>mdController</code> - Controller used to update the database with
                           conversations/messages</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../exception/XMLParsingException.html" title="class in com.tiyb.tev.exception">XMLParsingException</a></code></dd>
</dl>
</li>
</ul>
<a id="uploadMessagesForConvo(com.tiyb.tev.controller.TEVConvoRestController,java.util.List,java.lang.Long,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>uploadMessagesForConvo</h4>
<pre class="methodSignature">private static&nbsp;void&nbsp;uploadMessagesForConvo&#8203;(<a href="../controller/TEVConvoRestController.html" title="class in com.tiyb.tev.controller">TEVConvoRestController</a>&nbsp;restController,
                                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="../datamodel/ConversationMessage.html" title="class in com.tiyb.tev.datamodel">ConversationMessage</a>&gt;&nbsp;messages,
                                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Long.html?is-external=true" title="class or interface in java.lang" class="externalLink">Long</a>&nbsp;convoID,
                                           <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;blogName)</pre>
<div class="block">Helper function to upload messages for a given conversation</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>restController</code> - The controller for accessing the REST API</dd>
<dd><code>messages</code> - The messages to upload</dd>
<dd><code>convoID</code> - The ID of the conversation</dd>
</dl>
</li>
</ul>
<a id="getMessages(javax.xml.stream.XMLEventReader,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMessages</h4>
<pre class="methodSignature">private static&nbsp;<a href="ConversationXmlReader.MessageSuperStructure.html" title="class in com.tiyb.tev.xml">ConversationXmlReader.MessageSuperStructure</a>&nbsp;getMessages&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLEventReader.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLEventReader</a>&nbsp;reader,
                                                                       <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tumblrUserID)
                                                                throws <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLStreamException.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLStreamException</a></pre>
<div class="block">Gets a list of messages (stops when the end of the conversation is reached).
 The two attributes are read (via
 <a href="#readMessageAttributes(javax.xml.stream.events.StartElement,com.tiyb.tev.datamodel.ConversationMessage,java.lang.String)"><code>readMessageAttributes()</code></a>), followed by the text of the element.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>reader</code> - Stream containing the XML document being read</dd>
<dd><code>tumblrUserID</code> - Tumblr ID of the TEV user</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>list of messages, instead a
         <a href="ConversationXmlReader.MessageSuperStructure.html" title="class in com.tiyb.tev.xml"><code>MessageSuperStructure</code></a> object</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLStreamException.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLStreamException</a></code></dd>
</dl>
</li>
</ul>
<a id="readImageMessage(javax.xml.stream.XMLEventReader)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readImageMessage</h4>
<pre class="methodSignature">private static&nbsp;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;readImageMessage&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLEventReader.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLEventReader</a>&nbsp;reader)
                                throws <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLStreamException.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLStreamException</a></pre>
<div class="block">This helper method reads in message content for IMAGE messages. The structure
 of an IMAGE is different from other messages; typically, the message contents
 are simply the child text of the "message" element, but when the type is
 IMAGE, there is a child "photo-url" element as well. The "photo-url" also has
 a max-width attribute, but this app ignores it</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>reader</code> - The event reader containing the XML document</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String for the message content - i.e., the photo's URL</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLStreamException.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLStreamException</a></code></dd>
</dl>
</li>
</ul>
<a id="readMessageAttributes(javax.xml.stream.events.StartElement,com.tiyb.tev.datamodel.ConversationMessage,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readMessageAttributes</h4>
<pre class="methodSignature">private static&nbsp;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;readMessageAttributes&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/events/StartElement.html?is-external=true" title="class or interface in javax.xml.stream.events" class="externalLink">StartElement</a>&nbsp;startElement,
                                            <a href="../datamodel/ConversationMessage.html" title="class in com.tiyb.tev.datamodel">ConversationMessage</a>&nbsp;currentMessage,
                                            <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tumblrUserID)</pre>
<div class="block">Helper method to read in a message's attributes</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>startElement</code> - The <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/events/StartElement.html?is-external=true" title="class or interface in javax.xml.stream.events" class="externalLink"><code>StartElement</code></a> object currently being processed</dd>
<dd><code>currentMessage</code> - The message to add the data to</dd>
<dd><code>tumblrUserID</code> - The ID of the main user</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The ID of the participant</dd>
</dl>
</li>
</ul>
<a id="getParticipantName(javax.xml.stream.XMLEventReader,java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getParticipantName</h4>
<pre class="methodSignature">private static&nbsp;<a href="ConversationXmlReader.Participant.html" title="class in com.tiyb.tev.xml">ConversationXmlReader.Participant</a>&nbsp;getParticipantName&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLEventReader.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLEventReader</a>&nbsp;reader,
                                                                    <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;tumblrUserName)
                                                             throws <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLStreamException.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLStreamException</a></pre>
<div class="block">Helper function to get the participant name (and avatar URL) from a
 conversation. Each conversation contains a list of exactly two participants:
 the TEV user, and the <i>other</i> participant. Each "participant" element is
 read, and the one that is <i>not</i> that of the current Tumblr user is
 returned.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>reader</code> - The reader from which to read the "participant"
                       elements</dd>
<dd><code>tumblrUserName</code> - Tumblr name of the TEV user</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Helper <a href="ConversationXmlReader.Participant.html" title="class in com.tiyb.tev.xml"><code>Participant</code></a> object, with the details of the <i>other</i>
         (non-TEV-user) participant in the conversation</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.xml/javax/xml/stream/XMLStreamException.html?is-external=true" title="class or interface in javax.xml.stream" class="externalLink">XMLStreamException</a></code></dd>
</dl>
</li>
</ul>
<a id="fixName(java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>fixName</h4>
<pre class="methodSignature">private static&nbsp;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;fixName&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;participantName)</pre>
<div class="block">Helper function used to "fix" names for deactivated users. When a user has
 been deactivated, Tumblr returns the name as
 <code>username-deactivated</code> or
 <code>username-deactivatedyyyymmdd</code> or even
 <code>username-deact</code>. This function just keeps the username, without
 the "-deactivated" or "-deactivatedyyyymmdd" part.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>participantName</code> - "raw" username</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Username without the postfix (if any)</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ConversationXmlReader.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2020. All rights reserved.</small></p>
</footer>
</body>
</html>
