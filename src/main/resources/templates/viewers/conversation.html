<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title th:text="${conversation.participant}"></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <link rel="stylesheet" type="text/css" th:href="@{/owr/postviewers.css}"/>
</head>
<body>

<div class="contentContainer">
<h1 th:utext="'Conversation with ' + ${conversation.participant}"></h1>
<p>
	<button id="hideConvoBtn" th:text="#{conversation.hideConvoBtn}"></button>
	<button id="hideConvoAndRefreshBtn" th:text="#{conversation.hideConvoAndRefreshBtn}"></button>
</p>
<table id="messagesTable">
<tr th:each="message: ${messages}">
	<td>
		<div th:if="${message.received}" class="message-received">
		<table th:if="${message.received}" width="100%"><tr>
			<td width="5%"><img th:src="${conversation.participantAvatarUrl}" height="30px" width="30px" /></td>
			<td width="auto">
				<div th:text="${#dates.format(message.timestamp * 1000, 'MMM dd, yyyy, HH:mm')}"></div>
				<div th:switch="${message.type}">
					<p th:case="'POSTREF'"><a th:href="${message.message}" th:text="${message.message}" target="_blank"></a></p>
					<p th:case="'IMAGE'"><img th:src="${message.message}"></p>
					<p th:case="*" th:text="${message.message}"></p>
				</div>
			</td>
		</tr></table>
		</div>
		<div th:unless="${message.received}" class="message-sent">
		<table th:unless="${message.received}" width="100%"><tr>
			<td width="auto">
				<div th:text="${#dates.format(message.timestamp * 1000, 'MMM dd, yyyy, HH:mm')}"></div>
				<div th:text="${message.message}"></div>
			</td>
			<td width="5%"><img th:src="${metadata.mainTumblrUserAvatarUrl}" height="30px" width="30px"  /></td>
		</tr></table>
		</div> 
	</td>
</tr>
</table>
</div>
<script type="text/javascript">var participant = '[[${conversation.participant}]]';</script>
<script type="text/javascript" th:src="@{/owr/jquery.js}"></script>
<script type="text/javascript" th:src="@{/owr/postviewers.js}"></script>
</body>
</html>